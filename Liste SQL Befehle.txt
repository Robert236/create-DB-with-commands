Die Befehle werden in MySQL-Server nacheinander eingegeben!

CREATE DATABASE aufgabe_spitta;

CREATE TABLE Kunden (KDNR int NOT NULL AUTO_INCREMENT, NAME varchar(40), STRASSE varchar(40), HAUSNR varchar(12), LAND varchar(4), ORT varchar(40), TELNR varchar(30), MAILBOX varchar(60), PRIMARY KEY (KDNR));
CREATE TABLE Bestellungen (BESTNR int NOT NULL AUTO_INCREMENT, KDNR int NOT NULL, HERKUNFT varchar(20), BESTDT date, UMSATZ int, PRIMARY KEY (BESTNR), FOREIGN KEY (KDNR) REFERENCES Kunden(KDNR)); 
CREATE TABLE Artikel (PRODUKTNR int NOT NULL AUTO_INCREMENT, BESTNR int NOT NULL, UMSATZ_PRODUKT int, PRODUKTGRUPPE varchar(15), PRIMARY KEY (PRODUKTNR), FOREIGN KEY (BESTNR) REFERENCES Bestellungen(BESTNR));


DATA TO TABLE Kunden: Kunden insgesamt in der db: 6

INSERT INTO Kunden (NAME, STRASSE, HAUSNR, LAND, ORT, TELNR, MAILBOX) VALUES ('Robert', 'Im See', '21', 'DE', 'Ergenzingen', '07457/3760', 'robertvater1@googlemail.com');
INSERT INTO Kunden (NAME, STRASSE, HAUSNR, LAND, ORT, TELNR, MAILBOX) VALUES ('Person1', 'Adresse1', '1', 'DE', 'Ort1', '11111', 'E-Mail1');
INSERT INTO Kunden (NAME, STRASSE, HAUSNR, LAND, ORT, TELNR, MAILBOX) VALUES ('Person2', 'Adresse2', '2', 'FR', 'Ort2', '22222', 'E-Mail2');
INSERT INTO Kunden (NAME, STRASSE, HAUSNR, LAND, ORT, TELNR, MAILBOX) VALUES ('Person3', 'Adresse3', '3', 'DE', 'Ort3', '33333', 'E-Mail3');
INSERT INTO Kunden (NAME, STRASSE, HAUSNR, LAND, ORT, TELNR, MAILBOX) VALUES ('Person4', 'Adresse4', '4', 'FR', 'Ort4', '44444', 'E-Mail4');
INSERT INTO Kunden (NAME, STRASSE, HAUSNR, LAND, ORT, TELNR, MAILBOX) VALUES ('Person5', 'Adresse5', '5', 'DE', 'Ort5', '55555', 'E-Mail5');

DATA TO TABLE Bestellungen: Bestellungen insgesamt in der db: 9

INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (2, 'Brief', '2024-03-02', 1500);
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (1, 'Brief', '2024-02-13', 2000);
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (1, 'Online', '2024-01-01', 600);
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (5, 'Telefon', '2024-01-15', 10000);
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (4, 'Telefon', '2024-03-01', 7500);
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (1, 'Online', '2022-06-16', 350);  in range, DE true
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (3, 'Brief', '2021-03-15', 550); in range, DE false
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (6, 'Telefon', '2021-12-17', 7500); in range, DE true
INSERT INTO Bestellungen (KDNR, HERKUNFT, BESTDT, UMSATZ) VALUES (4, 'Telefon', '2023-05-01', 210); in range, DE true

Aufgabe a) Erstes SQL-Statement:

SELECT SUM(UMSATZ) FROM Bestellungen WHERE HERKUNFT='Brief'; (Antwort)

Aufgabe b) Zweites SQL-Statement:

SELECT KDNR ,BESTDT FROM Bestellungen WHERE BESTDT BETWEEN '2021-01-01' and '2023-12-29'; (erster Versuch)
SELECT Bestellungen.KDNR ,Bestellungen.BESTDT FROM Bestellungen WHERE BESTDT BETWEEN '2021-01-01' and '2023-12-29'; (zweier Versuch)

SELECT Bestellungen.KDNR ,Bestellungen.BESTDT FROM Bestellungen WHERE BESTDT BETWEEN '2021-01-01' and '2023-12-29' AND (SELECT LAND FROM Kunden WHERE Bestellungen.KDNR=Kunden.KDNR)='DE'; (Antwort)
SELECT Bestellungen.KDNR ,Bestellungen.BESTDT FROM Bestellungen WHERE BESTDT BETWEEN '2021-01-01' and '2023-12-29' AND (SELECT LAND FROM Kunden WHERE Bestellungen.KDNR=Kunden.KDNR)='FR'; (GegenprÃ¼fung)

DATE TO TABLE Artikel: Artikel insgesamt in der db: 15

INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (1, 505, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (1, 620, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (1, 930, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (3, 50, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (3, 120, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (2, 1100, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (4, 580, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (4, 660, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (5, 260, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (6, 30, 'KVZ');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (7, 630, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (7, 840, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (9, 70, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (9, 420, 'KVM');
INSERT INTO Artikel (BESTNR, UMSATZ_PRODUKT, PRODUKTGRUPPE) VALUES (8, 10, 'KVZ');

Aufgabe c) Drittes SQL-Statement:

SELECT Kunden.KDNR, Kunden.NAME, Kunden.TELNR, Bestellungen.BESTNR, Bestellungen.UMSATZ FROM Kunden RIGHT OUTER JOIN Bestellungen ON Kunden.KDNR=Bestellungen.KDNR ORDER BY Kunden.KDNR; (erster Versuch)

SELECT Artikel.PRODUKTNR, Bestellungen.KDNR, Bestellungen.BESTNR, Bestellungen.BESTDT, Artikel.UMSATZ_PRODUKT, Artikel.PRODUKTGRUPPE FROM Bestellungen RIGHT OUTER JOIN Artikel ON Bestellungen.BESTNR=Artikel.BESTNR WHERE Artikel.PRODUKTGRUPPE='KVZ' AND Bestellungen.BESTDT>='2023-01-01'; (zweiter Versuch)
SELECT Artikel.PRODUKTNR, Bestellungen.KDNR, Bestellungen.BESTNR, Bestellungen.BESTDT, Artikel.UMSATZ_PRODUKT, Artikel.PRODUKTGRUPPE FROM Bestellungen RIGHT OUTER JOIN Artikel ON Bestellungen.BESTNR=Artikel.BESTNR WHERE Artikel.PRODUKTGRUPPE='KVZ' AND Bestellungen.BESTDT>='2023-01-01' ORDER BY Artikel.UMSATZ_PRODUKT DESC; (?)